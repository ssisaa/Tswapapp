import{P as p,d as h,T as z,A as O,a as M,S as U}from"./index-DnSOJAIb.js";var k=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],F=function(){function e(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return e.prototype.resize_if_necessary=function(t){if(this.buffer_size-this.offset<t){this.buffer_size=Math.max(this.buffer_size*2,this.buffer_size+t);var n=new ArrayBuffer(this.buffer_size);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n,this.view=new DataView(n)}},e.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},e.prototype.store_value=function(t,n){var r=n.substring(1),o=parseInt(r)/8;this.resize_if_necessary(o);var i=n[0]==="f"?"setFloat".concat(r):n[0]==="i"?"setInt".concat(r):"setUint".concat(r);this.view[i](this.offset,t,!0),this.offset+=o},e.prototype.store_bytes=function(t){this.resize_if_necessary(t.length),new Uint8Array(this.buffer).set(new Uint8Array(t),this.offset),this.offset+=t.length},e}(),L=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function I(e){return Array.isArray(e)||!!e&&typeof e=="object"&&"length"in e&&typeof e.length=="number"&&(e.length===0||e.length>0&&e.length-1 in e)}function a(e,t,n){if(typeof e!==t)throw new Error("Expected ".concat(t," not ").concat(typeof e,"(").concat(e,") at ").concat(n.join(".")))}function W(e,t){var n=["number","string","bigint","boolean"].includes(typeof e),r=typeof e=="object"&&e!==null&&"toString"in e;if(!n&&!r)throw new Error("Expected bigint, number, boolean or string not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}function B(e,t,n){if(e!==t)throw new Error("Array length ".concat(e," does not match schema length ").concat(t," at ").concat(n.join(".")))}function D(e,t){if(typeof e!="object"||e===null)throw new Error("Expected object not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}var j=k.concat(["bool","string"]),A=["option","enum","array","set","map","struct"],u=function(e){L(t,e);function t(n,r){var o="Invalid schema: ".concat(JSON.stringify(n)," expected ").concat(r);return e.call(this,o)||this}return t}(Error);function s(e){if(!(typeof e=="string"&&j.includes(e))){if(e&&typeof e=="object"){var t=Object.keys(e);if(t.length===1&&A.includes(t[0])){var n=t[0];if(n==="option")return s(e[n]);if(n==="enum")return H(e[n]);if(n==="array")return K(e[n]);if(n==="set")return s(e[n]);if(n==="map")return J(e[n]);if(n==="struct")return N(e[n])}}throw new u(e,A.join(", ")+" or "+j.join(", "))}}function H(e){if(!Array.isArray(e))throw new u(e,"Array");for(var t=0,n=e;t<n.length;t++){var r=n[t];if(typeof r!="object"||!("struct"in r))throw new Error('Missing "struct" key in enum schema');if(typeof r.struct!="object"||Object.keys(r.struct).length!==1)throw new Error('The "struct" in each enum must have a single key');s({struct:r.struct})}}function K(e){if(typeof e!="object")throw new u(e,"{ type, len? }");if(e.len&&typeof e.len!="number")throw new Error("Invalid schema: ".concat(e));if("type"in e)return s(e.type);throw new u(e,"{ type, len? }")}function J(e){if(typeof e=="object"&&"key"in e&&"value"in e)s(e.key),s(e.value);else throw new u(e,"{ key, value }")}function N(e){if(typeof e!="object")throw new u(e,"object");for(var t in e)s(e[t])}var V=function(){function e(t){this.encoded=new F,this.fieldPath=["value"],this.checkTypes=t}return e.prototype.encode=function(t,n){return this.encode_value(t,n),this.encoded.get_used_buffer()},e.prototype.encode_value=function(t,n){if(typeof n=="string"){if(k.includes(n))return this.encode_integer(t,n);if(n==="string")return this.encode_string(t);if(n==="bool")return this.encode_boolean(t)}if(typeof n=="object"){if("option"in n)return this.encode_option(t,n);if("enum"in n)return this.encode_enum(t,n);if("array"in n)return this.encode_array(t,n);if("set"in n)return this.encode_set(t,n);if("map"in n)return this.encode_map(t,n);if("struct"in n)return this.encode_struct(t,n)}},e.prototype.encode_integer=function(t,n){var r=parseInt(n.substring(1));r<=32||n=="f64"?(this.checkTypes&&a(t,"number",this.fieldPath),this.encoded.store_value(t,n)):(this.checkTypes&&W(t,this.fieldPath),this.encode_bigint(BigInt(t),r))},e.prototype.encode_bigint=function(t,n){for(var r=n/8,o=new Uint8Array(r),i=0;i<r;i++)o[i]=Number(t&BigInt(255)),t=t>>BigInt(8);this.encoded.store_bytes(new Uint8Array(o))},e.prototype.encode_string=function(t){this.checkTypes&&a(t,"string",this.fieldPath);for(var n=t,r=[],o=0;o<n.length;o++){var i=n.charCodeAt(o);i<128?r.push(i):i<2048?r.push(192|i>>6,128|i&63):i<55296||i>=57344?r.push(224|i>>12,128|i>>6&63,128|i&63):(o++,i=65536+((i&1023)<<10|n.charCodeAt(o)&1023),r.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63))}this.encoded.store_value(r.length,"u32"),this.encoded.store_bytes(new Uint8Array(r))},e.prototype.encode_boolean=function(t){this.checkTypes&&a(t,"boolean",this.fieldPath),this.encoded.store_value(t?1:0,"u8")},e.prototype.encode_option=function(t,n){t==null?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(t,n.option))},e.prototype.encode_enum=function(t,n){this.checkTypes&&D(t,this.fieldPath);for(var r=Object.keys(t)[0],o=0;o<n.enum.length;o++){var i=n.enum[o];if(r===Object.keys(i.struct)[0])return this.encoded.store_value(o,"u8"),this.encode_struct(t,i)}throw new Error("Enum key (".concat(r,") not found in enum schema: ").concat(JSON.stringify(n)," at ").concat(this.fieldPath.join(".")))},e.prototype.encode_array=function(t,n){if(I(t))return this.encode_arraylike(t,n);if(t instanceof ArrayBuffer)return this.encode_buffer(t,n);throw new Error("Expected Array-like not ".concat(typeof t,"(").concat(t,") at ").concat(this.fieldPath.join(".")))},e.prototype.encode_arraylike=function(t,n){n.array.len?B(t.length,n.array.len,this.fieldPath):this.encoded.store_value(t.length,"u32");for(var r=0;r<t.length;r++)this.encode_value(t[r],n.array.type)},e.prototype.encode_buffer=function(t,n){n.array.len?B(t.byteLength,n.array.len,this.fieldPath):this.encoded.store_value(t.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(t))},e.prototype.encode_set=function(t,n){this.checkTypes&&a(t,"object",this.fieldPath);var r=t instanceof Set,o=r?Array.from(t.values()):Object.values(t);this.encoded.store_value(o.length,"u32");for(var i=0,c=o;i<c.length;i++){var f=c[i];this.encode_value(f,n.set)}},e.prototype.encode_map=function(t,n){this.checkTypes&&a(t,"object",this.fieldPath);var r=t instanceof Map,o=r?Array.from(t.keys()):Object.keys(t);this.encoded.store_value(o.length,"u32");for(var i=0,c=o;i<c.length;i++){var f=c[i];this.encode_value(f,n.map.key),this.encode_value(r?t.get(f):t[f],n.map.value)}},e.prototype.encode_struct=function(t,n){this.checkTypes&&a(t,"object",this.fieldPath);for(var r=0,o=Object.keys(n.struct);r<o.length;r++){var i=o[r];this.fieldPath.push(i),this.encode_value(t[i],n.struct[i]),this.fieldPath.pop()}},e}();function R(e,t,n){n===void 0&&(n=!0),n&&s(e);var r=new V(n);return r.encode(t,e)}const E=new p("Cohae9agySEgC9gyJL1QHCJWw4q58R7Wshr3rpPJHU7L"),Y="2EmUMo6kgmospSja3FUpYT3Yrps2YjHJtU9oZohr5GPF",q="GcsjAVWYaTce9cpFLm2eGhRjZauvtSP3z3iMrZsrMW8n",d=class d{constructor(t){this.instruction=0,this.liquidityContributionBps=t.liquidityContributionBps,this.adminFeeBps=t.adminFeeBps,this.referralBps=t.referralBps,this.swapFeeBps=t.swapFeeBps,this.yosCashbackBps=t.yosCashbackBps}};d.schema=new Map([[d,{kind:"struct",fields:[["instruction","u8"],["liquidityContributionBps","u16"],["adminFeeBps","u16"],["referralBps","u16"],["swapFeeBps","u16"],["yosCashbackBps","u16"]]}]]);let y=d;const l=class l{constructor(t){this.instruction=1,this.amount=t.amount}};l.schema=new Map([[l,{kind:"struct",fields:[["instruction","u8"],["amount","u64"]]}]]);let x=l;const b=class b{constructor(t){this.instruction=2,this.amount=t.amount}};b.schema=new Map([[b,{kind:"struct",fields:[["instruction","u8"],["amount","u64"]]}]]);let P=b;function S(){return p.findProgramAddressSync([Buffer.from("program_state")],E)}async function Z(){try{const[e]=S();return await h.getAccountInfo(e)!==null}catch(e){return console.error("Error checking program initialization:",e),!1}}async function C(e){try{if(!(e!=null&&e.publicKey))throw new Error("Wallet not connected");console.log("Starting program initialization...");const t={liquidityContributionBps:2e3,adminFeeBps:10,referralBps:50,swapFeeBps:30,yosCashbackBps:500},[n,r]=S();console.log("Program state address:",n.toBase58());const o=new z,i=new p(Y),c=new p(q),f=new p(O),v=new y(t),T=R(y.schema,v),m=new M({keys:[{pubkey:e.publicKey,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:U.programId,isSigner:!1,isWritable:!1}],programId:E,data:Buffer.from(T)});o.add(m);const g=await h.getLatestBlockhash();o.recentBlockhash=g.blockhash,o.feePayer=e.publicKey;const _=await e.sendTransaction(o,h);console.log("Program initialized successfully with signature:",_);const w=await h.confirmTransaction({signature:_,blockhash:g.blockhash,lastValidBlockHeight:g.lastValidBlockHeight});if(w.value.err)throw new Error(`Transaction confirmed but failed: ${w.value.err}`);return _}catch(t){throw console.error("Error in initializeMultiHubSwapProgram:",t),t}}export{C as initializeMultiHubSwapProgram,Z as isMultiHubSwapProgramInitialized};
